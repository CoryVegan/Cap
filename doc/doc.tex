\documentclass[10pt, oneside]{article}   	% use "amsart" instead of "article" for AMSLaTeX format
\usepackage{geometry}                		% See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   		% ... or a4paper or a5paper or ... 
%\geometry{landscape}                		% Activate for for rotated page geometry
%\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}				% Use pdf, png, jpg, or epsÂ§ with pdflatex; use eps in DVI mode
								% TeX will automatically convert eps --> pdf in pdflatex		
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows,calc,3d,chains,fit,decorations.markings}
\usepackage{circuitikz}



\begin{document}

\section{Geometry}

\tikzstyle{vecArrow} = [thick, decoration={markings,mark=at position
   1 with {\arrow[semithick]{open triangle 60}}},
   double distance=1.4pt, shorten >= 5.5pt,
   preaction = {decorate},
   postaction = {draw,line width=1.4pt, white,shorten >= 4.5pt}]
\tikzstyle{innerWhite} = [semithick, white,line width=1.4pt, shorten >= 4.5pt]

\newcommand\xorig{0}
\newcommand\hs{25}
\newcommand\ys{0}
\newcommand\yacc{0}
\newcommand\hacc{30}
\newcommand\yccc{-5}
\newcommand\hccc{30}
\newcommand\wacc{5}
\newcommand\wea{50}
\newcommand\ws{25}
\newcommand\wec{50}
\newcommand\wccc{5}
\newcommand\xacc{\xorig}
\newcommand\xea{\xacc+\wacc}
\newcommand\xs{\xea+\wea}
\newcommand\xec{\xs+\ws}
\newcommand\xccc{\xec+\wec}
\begin{tikzpicture}[scale=0.1]
\draw[thick] (\xea,\ys) -- (\xea,\ys+\hs) -- (\xea+\wea,\ys+\hs) -- (\xea+\wea,\ys) -- (\xea,\ys);
\draw[thick] (\xs ,\ys) -- (\xs ,\ys+\hs) -- (\xs +\ws ,\ys+\hs) -- (\xs +\ws ,\ys) -- (\xs ,\ys);
\draw[thick] (\xec,\ys) -- (\xec,\ys+\hs) -- (\xec+\wec,\ys+\hs) -- (\xec+\wec,\ys) -- (\xec,\ys);
\draw[thick] (\xacc,\yacc) -- (\xacc,\yacc+\hacc) -- (\xacc+\wacc,\yacc+\hacc) -- (\xacc+\wacc,\yacc) -- (\xacc,\yacc);
\draw[thick] (\xccc,\yccc+\hccc) -- (\xccc,\yccc) -- (\xccc+\wccc,\yccc) -- (\xccc+\wccc,\yccc+\hccc) -- (\xccc,\yccc+\hccc);
\draw node at (\xea +0.5*\wea ,\ys+0.5*\hs) {$\Omega^{electrode\ anode}$  };
\draw node at (\xs  +0.5*\ws  ,\ys+0.5*\hs) {$\Omega^{separator}$         };
\draw node at (\xec +0.5*\wec ,\ys+0.5*\hs) {$\Omega^{electrode\ cathode}$};
\draw node at (\xacc+0.5*\wacc,\ys+0.5*\hs) {$\Omega^{collector\ anode}$  };
\draw node at (\xccc+0.5*\wccc,\ys+0.5*\hs) {$\Omega^{collector\ cathode}$};

\draw node[anchor=south] at (\xacc+0.5*\wacc,\yacc+\hacc) {$\Gamma^{anode}$  }; 
\draw node[anchor=north] at (\xccc+0.5*\wccc,\yccc      ) {$\Gamma^{cathode}$};
\end{tikzpicture}

non overlapping domains
%$\Omega^{collector\ anode}$ 
%$\Omega^{electrode\ anode}$ 
%$\Omega^{separator}$  
%$\Omega^{electrode\ cathode}$
%$\Omega^{collector\ cathode}$
with common interfaces

define 
$\Gamma^{anode}$  
and
$\Gamma^{cathode}$  
as the two terminals of the device

\section{Governing equations}
%----------------------------------------------------------------------------- 
% ELECTROCHEMICAL
%----------------------------------------------------------------------------- 
\subsection{Electrochemical}

Governing equations for the electrolyte potential $\Phi_l$ and the solid phase
potential $\Phi_s$ are
\begin{align}
aC (\dot{\Phi}_l - \dot{\Phi}_s) &= \nabla \cdot (\sigma_l \nabla \Phi_l) \text{ on } \Omega^{electrode} \\
aC (\dot{\Phi}_s - \dot{\Phi}_l) &= \nabla \cdot (\sigma_s \nabla \Phi_s) \text{ on } \Omega^{electrode} \\
0 &= \nabla \cdot (\sigma_l \nabla \Phi_l) \text{ on } \Omega^{separator} \\
0 &= \nabla \cdot (\sigma_s \nabla \Phi_s) \text{ on } \Omega^{collector}
\end{align}
$aC$ is the specific capacitance. In our model, we assume it accounts for both 
double-layer capacitance and pseudocapacitance. $a$ is the interfacial area
per unit volume.

$\sigma_s$ and $\sigma_l$ are the electrolyte and solid phase electrical
conductivities. They are effective transport properties.

In our current model, we have
$\sigma_l=\sigma_{l0}\varepsilon^\zeta$ and
$\sigma_s=\sigma_{s0}(1-\varepsilon)^\zeta$.
$\varepsilon$ is the porous medium void volume fraction,
$\zeta$ is the Bruggeman's coefficient (taken equal to $3/2$)...

[Interface conditions]
coming soon... (basically continuity of the fluxes within both phases)

[Boundary conditions]
arbitarily anode current collector ``grounded''
\begin{equation}
\Phi_s = 0 \text{\ on\ } \Gamma^{anode}
\end{equation}

choose from
\begin{enumerate}
\item Potentiostatic charge/discharge \\
$\Phi_s = U \text{\ on\ } \Gamma^{cathode}$
i.e. constant voltage charge/discharge

\item Galvanostatic charge/discharge \\
$\sigma_s \frac{\partial \Phi_s}{\partial n} = I / S^{cathode} \text{\ on\ } \Gamma^{cathode}$
i.e. constant current charge/discharge

\item Relaxation \\
nothing
\end{enumerate}

here $S^{cathode}$ represents the surface area of the terminal on the cathode
current collector (over which we impose the current density flowing into the
device)
\begin{equation}
S^{cathode} = \int_{\Gamma^{cathode}} dS
\end{equation}

%----------------------------------------------------------------------------- 
% THERMAL
%----------------------------------------------------------------------------- 
\subsection{Thermal}

The temperature field $\Theta$ obeys
\begin{equation}
\rho C_p \dot{\Theta} = \nabla \cdot (\lambda \nabla \Theta) + q \text{ on } \Omega
\label{eq:heat_conduction}
\end{equation}
This is a standard heat conduction equation.
Material properties $\rho$, $C_p$ and $\lambda$ are density, heat capacity and
thermal conductivity.
$q=q^{reversible}+q^{irreversible}$ is the heat source.
\begin{itemize}
\item[$\diamond$] $q^{irr} = \sigma | \nabla \Phi |^2$: Joule heating (ohmic
losses $\propto R I^2$ when current traverse resistive material)

\item[$\diamond$] $q^{rev} = \pm \frac{2 k_B \Theta}{e} \ln(\frac{V_H}{V_0}) |
\sigma \nabla \Phi |$: changes in entropy (ions in the electrolyte of a double
layer capacitor are arranged in the electric field during charging and are
spreading themselves again during discharging)
\end{itemize}

In the current model, we have $q^{rev} = \pm \alpha |\sigma \nabla\Phi|$ where
$\alpha$ is a constant.

[Boundary conditions]
\begin{equation}
- \lambda \frac{\partial \Theta}{\partial n} = h (\Theta - \Theta_{ambient}) \text{ on } \partial\Omega
\end{equation}
heat transfer coefficient $h$ and ambient temperature $\Theta_{ambient}$

%-----------------------------------------------------------------------------
% DAMON
%-----------------------------------------------------------------------------
\newpage
\section{Inadequacy}
Damon, I suggest we start with a simple model of anisotropic heat conduction
with uniform heat source.

The scalar thermal conductivity $\lambda$ in \eqref{eq:heat_conduction} becomes 
a tensor 
\begin{equation}
\lambda = 
\begin{bmatrix}
\lambda_x & 0         & 0         \\
0         & \lambda_y & 0         \\
0         & 0         & \lambda_z \\
\end{bmatrix}
\end{equation}
and I suppose we can define something like
\begin{equation}
\lambda_x = \frac{\lambda^{electrode} 2w^{electrode} + \lambda^{separator} w^{separator} + \lambda^{collector} 2w^{collector}}{w^{sanwhich}}
\end{equation}
and
\begin{equation}
\lambda_y = \lambda_z = \frac{w^{sandwich}}{\frac{2w^{electrode}}{\lambda^{electrode}} + \frac{w^{separator}}{\lambda^{separator}} + \frac{2w^{collector}}{\lambda^{collector}}}
\end{equation}

where $w^{sandwich}=2w^{electrode}+w^{separator}+2w^{collector}$

The heat source is approximated by $q = R^{sandwich} I^2 / V$.
where $V$ is the volume of the sandwhich and the electrical resistance
$R^{sandwich}$ is computed as
\begin{equation}
R^{sandwich} = 
\frac{2w^{electrode}}{A} (\frac{1}{\sigma_l^{electrode}} + \frac{1}{\sigma_s^{electrode}})
+ \frac{w^{separator}}{A} \frac{1}{\sigma_l^{separator}}
+ \frac{2w^{collector}}{A} \frac{1}{\sigma_s^{collector}}
\end{equation}

\begin{circuitikz}
\draw (0,0) to[R=$R_s^{collector}$] (2,0); 
\draw (2,0) to[short] (2,1) to[R=$R_s^{electrode}$] (4,1) to[short] (4,0);
\draw (2,0) to[short] (2,-1) to[R=$R_l^{electrode}$] (4,-1) to[short] (4,0);
\draw (4,0) to[R=$R_l^{separator}$] (6,0); 
\draw (6,0) to[short] (6,1) to[R=$R_s^{electrode}$] (8,1) to[short] (8,0);
\draw (6,0) to[short] (6,-1) to[R=$R_l^{electrode}$] (8,-1) to[short] (8,0);
\draw (8,0) to[R=$R_s^{collector}$] (10,0); 
\draw (11,0) node {$\equiv$}; 
\draw (12,0) to[R=$R^{sandwich}$] (14,0); 
\end{circuitikz}

Above is the corresponding equivalent circuit.
We use the formula $R=w/\sigma A$ (Pouillet's law).
$A$ is the cross-sectional area of the sandwich.
This assumes the current density is totally uniform in the medium.

Another option even cruder would be a 0-D equation...
\begin{equation}
m C_p \dot{\Theta} = Q - H (\Theta - \Theta_{ambient})
\end{equation}

%-----------------------------------------------------------------------------
% FLORIAN
%-----------------------------------------------------------------------------
\newpage
\section{Optimization}

The code outputs

\texttt{output\_params} \\
{\footnotesize
\begin{tabular}{llll}
Path                      &     & Units \\
\texttt{max\_temperature} & $\Theta_{max}$ & [K] \\
\texttt{heat\_production} & $Q$ & [W] \\
\texttt{voltage}          & $U$ & [V] \\
\texttt{current}          & $I$ & [A] \\
\texttt{time}             & $t$ & [s] \\
\texttt{capacitor\_state} \\
\texttt{cycle}            \\
\texttt{surface\_area}    & $S$ & [m$^2$] \\
\texttt{volume}           & $V$ & [m$^3$] \\
\texttt{mass}             & $M$ & [kg]    \\
\end{tabular}
}

heat production
\begin{equation}
Q = \int_\Omega q dV
\end{equation}

maximum temperature $\Theta_{max}$

potential difference between the two terminals
\begin{equation}
U = \int_{\Gamma^{cathode}} \Phi_s dS / S^{cathode} 
- \int_{\Gamma^{anode}} \Phi_s dS / S^{anode}
\end{equation}
[the second term is forced to zero]

current flowing through the supercapacitor
\begin{equation}
I = \int_{\Gamma^{cathode}} \sigma_s \frac{\partial \Phi_s}{\partial n} dS
\end{equation}

(one value at each time step)

\begin{equation}
V = \int_\Omega dV
\end{equation}

\begin{equation}
S = \int_{\Gamma^{cathode}} dV
\end{equation}

Quantities of interest are 

power $P=UI$

energy $E=\int_{t_0}^t P - Q d\tau$

efficiency $\eta=\frac{|P|-Q}{|P|}$

We want to maximize 

power density $P/M$

energy density $E/M$

efficiency

Constraints are 
temperature $\Theta$ and voltage $U$ must not exceed some threshold values.

{\footnotesize
\begin{tabular}{llll}
Path                      &     & Units \\
\texttt{quantities\_of\_interest.max\_temperature} & $\Theta_{max}$ & [K] \\
\texttt{quantities\_of\_interest.energy\_density}  & $E/M$          & [Wh/kg] \\
\texttt{quantities\_of\_interest.power\_density}   & $P/M$          & [W/kg] \\
\texttt{quantities\_of\_interest.efficiency}       & $\eta$         & [\%] \\
\end{tabular}
}


[note] 
I suspect the potential gradient should not exceed some maximum for safety,
i.e. $w^{separator}$ cannot go to zero...

The code takes as input

\texttt{input\_params} \\
{\footnotesize
\begin{tabular}{lllll}
  & Path                                                            & Parameter              & Value     & Units           \\
  & \texttt{material\_properties.separator\_density}                & $\rho^{separator}$     & 1.2528e3  & [kg/m$^3$]      \\
  & \texttt{material\_properties.electrode\_density}                & $\rho^{electrode}$     & 0.93e3    & [kg/m$^3$]      \\
  & \texttt{material\_properties.collector\_density}                & $\rho^{collector}$     & 2.7e3     & [kg/m$^3$]      \\
  & \texttt{material\_properties.separator\_heat\_capacity}         & $C_p^{separator}$      & 3.1404e3  & [J/K]           \\
  & \texttt{material\_properties.electrode\_heat\_capacity}         & $C_p^{electrode}$      & 1.34e3    & [J/K]           \\
  & \texttt{material\_properties.collector\_heat\_capacity}         & $C_p^{collector}$      & 0.89815e3 & [J/K]           \\
  & \texttt{material\_properties.separator\_thermal\_conductivity}  & $\lambda^{separator}$  & 0.0019e2  & [W/m$\cdot$K]   \\
  & \texttt{material\_properties.electrode\_thermal\_conductivity}  & $\lambda^{electrode}$  & 0.0011e2  & [W/m$\cdot$K]   \\
  & \texttt{material\_properties.collector\_thermal\_conductivity}  & $\lambda^{collector}$  & 2.37e2    & [W/m$\cdot$K]   \\
  & \texttt{operating\_conditions.charge\_potential}                & $U_{charge}$           & 2.2       & [V]             \\
  & \texttt{operating\_conditions.discharge\_potential}             & $U_{discharge}$        & 1.1       & [V]             \\
  & \texttt{operating\_conditions.charge\_current\_density}         & $I_{charge}$           & 324.65    & [A/m${2}$]      \\
  & \texttt{operating\_conditions.discharge\_current\_density}      & $I_{discharge}$        & -324.65   & [A/m${2}$]      \\
  & \texttt{material\_properties.specific\_capacitance}             & $aC$                   & 86.0e6    & [F/m$^3$]       \\
  & \texttt{material\_properties.separator\_void\_volume\_fraction} & $\epsilon^{separator}$ & 0.6       & [1]             \\
  & \texttt{material\_properties.electrode\_void\_volume\_fraction} & $\epsilon^{electrode}$ & 0.67      & [1]             \\
  & \texttt{material\_properties.electrolyte\_conductivity}         & $\sigma_{l0}$          & 0.067     & [S/m]           \\
  & \texttt{material\_properties.solid\_phase\_conductivity}        & $\sigma_{s0}$          & 52.1      & [S/m]           \\
  & \texttt{material\_properties.bruggemans\_coefficient}           & $\zeta$                & 1.5       & [1]             \\
  & \texttt{heat\_transfer\_coefficient}                            & $h$                    & 8.0e-2    & [W/m$^2\cdot$K] \\
  & \texttt{ambient\_temperature}                                   & $\Theta_{ambient}$     & 0.0       & [K]             \\
X & \texttt{geometry.electrode\_width}                              & $w^{electrode}$        & 50.0e-6   & [m]             \\
X & \texttt{geometry.separator\_width}                              & $w^{separator}$        & 25.0e-6   & [m]             \\
X & \texttt{geometry.collector\_width}                              & $w^{collector}$        &  5.0e-6   & [m]             \\
X & \texttt{geometry.sandwich\_height}                              & $h^{sandwich}$         & 25.0e-6   & [m]             \\
\end{tabular}
}

You will not be able to change the geometry for now. I marked the corresponding
input with an X. 
You may tune all the other parameters.







%-----------------------------------------------------------------------------
% BRENDAN
%-----------------------------------------------------------------------------
\newpage
\section{Uncertainty}


\end{document}  
